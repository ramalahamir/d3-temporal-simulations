import pandas as pd
import json

# using the files:
#    - GDP per capita (gdppercapita_us_inflation_adjusted.csv)
#    - Life expectancy (lex.csv)
#    - Population (population_total.csv)

def prepare_gapminder_data():
    """
    Converts Gapminder CSV files into a single JSON file suitable for D3.js
    """
    
    # Country to continent mapping
    continent_mapping = {
        "Afghanistan": "Asia",
        "Albania": "Europe",
        "Algeria": "Africa",
        "Angola": "Africa",
        "Argentina": "Americas",
        "Australia": "Oceania",
        "Austria": "Europe",
        "Bahrain": "Asia",
        "Bangladesh": "Asia",
        "Belgium": "Europe",
        "Benin": "Africa",
        "Bolivia": "Americas",
        "Bosnia and Herzegovina": "Europe",
        "Botswana": "Africa",
        "Brazil": "Americas",
        "Bulgaria": "Europe",
        "Burkina Faso": "Africa",
        "Burundi": "Africa",
        "Cambodia": "Asia",
        "Cameroon": "Africa",
        "Canada": "Americas",
        "Central African Republic": "Africa",
        "Chad": "Africa",
        "Chile": "Americas",
        "China": "Asia",
        "Colombia": "Americas",
        "Comoros": "Africa",
        "Congo, Dem. Rep.": "Africa",
        "Congo, Rep.": "Africa",
        "Costa Rica": "Americas",
        "Cote d'Ivoire": "Africa",
        "Croatia": "Europe",
        "Cuba": "Americas",
        "Czech Republic": "Europe",
        "Denmark": "Europe",
        "Djibouti": "Africa",
        "Dominican Republic": "Americas",
        "Ecuador": "Americas",
        "Egypt": "Africa",
        "El Salvador": "Americas",
        "Equatorial Guinea": "Africa",
        "Eritrea": "Africa",
        "Ethiopia": "Africa",
        "Finland": "Europe",
        "France": "Europe",
        "Gabon": "Africa",
        "Gambia": "Africa",
        "Germany": "Europe",
        "Ghana": "Africa",
        "Greece": "Europe",
        "Guatemala": "Americas",
        "Guinea": "Africa",
        "Guinea-Bissau": "Africa",
        "Haiti": "Americas",
        "Honduras": "Americas",
        "Hong Kong, China": "Asia",
        "Hungary": "Europe",
        "Iceland": "Europe",
        "India": "Asia",
        "Indonesia": "Asia",
        "Iran": "Asia",
        "Iraq": "Asia",
        "Ireland": "Europe",
        "Israel": "Asia",
        "Italy": "Europe",
        "Jamaica": "Americas",
        "Japan": "Asia",
        "Jordan": "Asia",
        "Kenya": "Africa",
        "Korea, Dem. Rep.": "Asia",
        "Korea, Rep.": "Asia",
        "Kuwait": "Asia",
        "Lebanon": "Asia",
        "Lesotho": "Africa",
        "Liberia": "Africa",
        "Libya": "Africa",
        "Madagascar": "Africa",
        "Malawi": "Africa",
        "Malaysia": "Asia",
        "Mali": "Africa",
        "Mauritania": "Africa",
        "Mauritius": "Africa",
        "Mexico": "Americas",
        "Mongolia": "Asia",
        "Montenegro": "Europe",
        "Morocco": "Africa",
        "Mozambique": "Africa",
        "Myanmar": "Asia",
        "Namibia": "Africa",
        "Nepal": "Asia",
        "Netherlands": "Europe",
        "New Zealand": "Oceania",
        "Nicaragua": "Americas",
        "Niger": "Africa",
        "Nigeria": "Africa",
        "Norway": "Europe",
        "Oman": "Asia",
        "Pakistan": "Asia",
        "Panama": "Americas",
        "Paraguay": "Americas",
        "Peru": "Americas",
        "Philippines": "Asia",
        "Poland": "Europe",
        "Portugal": "Europe",
        "Puerto Rico": "Americas",
        "Reunion": "Africa",
        "Romania": "Europe",
        "Rwanda": "Africa",
        "Sao Tome and Principe": "Africa",
        "Saudi Arabia": "Asia",
        "Senegal": "Africa",
        "Serbia": "Europe",
        "Sierra Leone": "Africa",
        "Singapore": "Asia",
        "Slovak Republic": "Europe",
        "Slovenia": "Europe",
        "Somalia": "Africa",
        "South Africa": "Africa",
        "Spain": "Europe",
        "Sri Lanka": "Asia",
        "Sudan": "Africa",
        "Swaziland": "Africa",
        "Sweden": "Europe",
        "Switzerland": "Europe",
        "Syria": "Asia",
        "Taiwan": "Asia",
        "Tanzania": "Africa",
        "Thailand": "Asia",
        "Togo": "Africa",
        "Trinidad and Tobago": "Americas",
        "Tunisia": "Africa",
        "Turkey": "Europe",
        "Uganda": "Africa",
        "United Kingdom": "Europe",
        "United States": "Americas",
        "Uruguay": "Americas",
        "Venezuela": "Americas",
        "Vietnam": "Asia",
        "West Bank and Gaza": "Asia",
        "Yemen, Rep.": "Asia",
        "Zambia": "Africa",
        "Zimbabwe": "Africa"
    }
    
    print("This is a template script.")
    print("Please download Gapminder data and adapt this script to your CSV structure.")
    print("\nExpected JSON structure has been documented in the code.")
    
    # Example: If you have a combined CSV file already:
    # df = pd.read_csv('gapminder_combined.csv')
    # df['continent'] = df['country'].map(continent_mapping)
    # result = df.to_json('gapminder.json', orient='records')

if __name__ == "__main__":
    prepare_gapminder_data()
